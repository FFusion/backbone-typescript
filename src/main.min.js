$(function(){new AppView});var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},AutoCollection=function(a){function b(){a.apply(this,arguments),this.localStorage=new Store("cars")}return __extends(b,a),b.prototype.nextNumber=function(){return this.length?this.last().get("id")+1:1},b}(Backbone.Collection),cars=new AutoCollection,snackHelpers=function(){function a(){}return a.prototype.shack=function(a){return $.snackbar(a)},a}(),AutoModel=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.defaults=function(){return{id:"1",mark:"Ваз",year:"2000",mileage:12e4,price:"620000",clerk:"Petr",phone:"Oleg"}},b}(Backbone.Model),auto=new AutoModel,Router=function(a){function b(){a.apply(this,arguments),this.routes={"/":"main","/car/:id":"car"}}return __extends(b,a),b.prototype.main=function(){$(".main-content").show(),$(".car-content").hide()},b.prototype.car=function(){$(".main-content").hide(),$(".car-content").show()},b}(Backbone.Router),controller=new Router;Backbone.history.start();var AppView=function(a){function b(){a.call(this),this.setElement($(".auto-list")),cars.fetch({reset:!0})}return __extends(b,a),b.prototype.initialize=function(){_.bindAll(this,"addCar"),this.mark=$("#mark"),this.year=$("#year"),this.mileage=$("#mileage"),this.price=$("#price"),this.clerk=$("#clerk"),this.phone=$("#phone"),cars.on("add",this.addCar,this),cars.on("reset",this.render,this)},b.prototype.events=function(){return{"click #add":"createNewCar"}},b.prototype.render=function(){return cars.each(this.addCar),this},b.prototype.addCar=function(a){var b=new CarView({model:a});$(".auto-list > table > tbody").append(b.render().el)},b.prototype.createNewCar=function(){cars.create({id:cars.nextNumber(),mark:this.mark.val(),year:this.year.val(),mileage:this.mileage.val(),price:this.price.val(),clerk:this.clerk.val(),phone:this.phone.val()}),this.mark.val(""),this.year.val(""),this.mileage.val(""),this.price.val(""),this.clerk.val(""),this.phone.val("")},b}(Backbone.View),CarView=function(a){function b(b){this.tagName="tr",a.call(this,b),this.template=_.template($("#car").html()),this.initialize()}return __extends(b,a),b.prototype.initialize=function(){this.model.on("change",this.render,this),this.listenTo(this.model,"destroy",this.remove)},b.prototype.events=function(){return{"click #delete":"deleteCar","click #look":"lookMore"}},b.prototype.render=function(){return this.$el.html(this.template(this.model.toJSON())),this},b.prototype.deleteCar=function(){this.model.destroy();var a=new snackHelpers;a.shack({content:"Успешно удалено",style:"toast text-center",timeout:2e3})},b.prototype.lookMore=function(){controller.car();new MoreView({model:this.model})},b.prototype.remove=function(){return this.$el.remove(),this},b}(Backbone.View),MoreView=function(a){function b(b){this.setElement($(".car-content")),this.template=_.template($("#carMore").html()),a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(){this.render()},b.prototype.events=function(){return{"click #back":"back"}},b.prototype.render=function(){return this.$el.html(this.template(this.model.toJSON())),this},b.prototype.back=function(){controller.navigate("/"),controller.main()},b}(Backbone.View);
//# sourceMappingURL=main.min.js.map